---
title: "Four Parameters Categorical"
format: html
author: "Inam Khan"
execute: 
  echo: false
---

```{r}
#| message: false

library(tidyverse)
library(primer.data)
library(tidymodels)
library(broom)
```

Understanding how voter preference varies by gender can help candidates tailor their campaign strategies more effectively. Using data from the 1992 National Election Studies survey, we explore the relationship between voter choice and sex in the U.S. presidential election. A potential limitation of our model is that survey respondents may not fully reflect the broader voting population, which could affect the generalizability of our findings.


$$
P(Y = k) = \frac{e^{\beta_{k0} + \beta_{k1} X_1 + \beta_{k2} X_2 + \cdots + \beta_{kn} X_n}}{\sum_{j=1}^{K} e^{\beta_{j0} + \beta_{j1} X_1 + \beta_{j2} X_2 + \cdots + \beta_{jn} X_n}}
$$

with $Y \sim \text{Multinomial}(\boldsymbol{\rho})$ where $\boldsymbol{\rho} = (\rho_1, \rho_2, \ldots, \rho_K)$ are the probabilities above.

$$
\hat{P}(\text{pres\_vote} = \text{Clinton}) = \frac{e^{0.455 - 0.255 \cdot \text{sex}_{\text{Male}}}}{1 + e^{0.455 - 0.255 \cdot \text{sex}_{\text{Male}}} + e^{-0.852 + 0.420 \cdot \text{sex}_{\text{Male}}}}
$$

$$
\hat{P}(\text{pres\_vote} = \text{Perot}) = \frac{e^{-0.852 + 0.420 \cdot \text{sex}_{\text{Male}}}}{1 + e^{0.455 - 0.255 \cdot \text{sex}_{\text{Male}}} + e^{-0.852 + 0.420 \cdot \text{sex}_{\text{Male}}}}
$$

$$
\hat{P}(\text{pres\_vote} = \text{Bush}) = 1 - \hat{P}(\text{Clinton}) - \hat{P}(\text{Perot})
$$

```{r}
#| label: prepare-data
#| cache: true

nes_92 <- nes |> 
  filter(year == 1992) |> 
  select(sex, pres_vote) |> 
  drop_na() |> 
  mutate(pres_vote = as.factor(case_when(
    pres_vote == "Democrat" ~ "Clinton",
    pres_vote == "Republican" ~ "Bush",
    pres_vote == "Third Party" ~ "Perot"
  )))
```
```{r}
#| label: fit-model
#| cache: true

fit_nes <- multinom_reg(engine = "nnet") |>
  fit(pres_vote ~ sex, data = nes_92)
```



